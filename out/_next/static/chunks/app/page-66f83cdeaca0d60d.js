(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4643:(e,t,n)=>{Promise.resolve().then(n.bind(n,3667))},3844:(e,t,n)=>{"use strict";n.r(t),n.d(t,{CloseButton:()=>s,GenericModal:()=>l,GenericPillButton:()=>i,PressDownButton:()=>a,default:()=>c});var r=n(1047),o=n(6847);function i(e){let{children:t,functionToTrigger:n,isFilled:o,isShort:i,additionalStyleObject:s,useOnClick:l}=e,d=i?"10px":"14px",c={borderRadius:"200px",paddingTop:d,paddingBottom:d,paddingLeft:"24px",paddingRight:"24px",display:"flex",alignItems:"center",justifyContent:"center",border:o?"none":"1px solid #3d3d3d",backgroundColor:o?u.purpleColor:"white",color:o?"white":"#3d3d3d",fontFamily:"Roboto, sans-serif",fontWeight:500,fontSize:"16px",cursor:"pointer",userSelect:"none"};return(s&&Object.assign(c,s),l)?(0,r.jsx)("button",{style:c,onClick:n,children:t}):l?void 0:(0,r.jsx)(a,{style:c,functionToTrigger:n,children:t})}function s(e){let{buttonWidthString:t,iconWidthString:n,color:o,onClickFunction:i,additionalStyleObject:s}=e,l={background:"none",border:"none",cursor:"pointer",padding:"0px",verticalAlign:"middle",display:"flex",alignItems:"center",justifyContent:"center",boxSizing:"border-box"};t&&(l.width=t,l.height=t),s&&Object.assign(l,s);let a=null;return n&&(a={width:n,height:n}),(0,r.jsx)("button",{style:l,onClick:i,children:(0,r.jsx)("img",{src:"".concat(u.iconsFolderPath,"/close_").concat(o,".svg"),alt:"Close",style:a})})}function l(e){let{refSetting:t,widthSetting:n,heightSetting:o,children:i,additionalStyleObject:s,blockBehind:l}=e,a={position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:n,height:o,backgroundColor:"white",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.45)",zIndex:3,overflow:"auto",padding:"20px",borderRadius:"24px"};return(s&&Object.assign(a,s),l)?l?(0,r.jsx)("div",{style:{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",backgroundColor:"#00000055",zIndex:"3"},children:(0,r.jsx)("div",{ref:t||null,style:a,children:i})}):void 0:(0,r.jsx)("div",{ref:t||null,style:a,children:i})}function a(e){let t=(0,o.useRef)(null);e.functionToTrigger||console.error("PressDownButton requires a functionToTrigger prop"),e.onClick&&console.warn("PressDownButton is not meant to use onClick prop");let n=function(t){t.preventDefault(),e.functionToTrigger()};(0,o.useEffect)(()=>(t.current.addEventListener("mousedown",n),t.current.addEventListener("touchstart",n),()=>{t.current&&(t.current.removeEventListener("mousedown",n),t.current.removeEventListener("touchstart",n))}),[]);let i={...e};return delete i.functionToTrigger,(0,r.jsxs)("button",{ref:t,...i,children:[" ",e.children," "]})}let d="/sam_browser/out",u={softBorderColor:"#A9A09E",hardBorderColor:"#000000",redColor:"#C56D61",purpleColor:"#55587B",nearBlackColor:"#3d3d3d",worksheetSelectionPanelWidth:"240px",colorMap:{red:"#BD1452",orange:"#FE9350",yellow:"#FFFB79",green:"#91D480",cyan:"#70D9FF",blue:"#2D4CA8",purple:"#8B2F99",pink:"#FF9FDC"},getGenericButtonStyle:function(e){return{padding:"10px",borderRadius:"8px",cursor:"pointer",borderColor:"black",borderStyle:"solid",...{primary:{backgroundColor:"black",color:"white",border:"none"},secondary:{backgroundColor:"white",color:"black"},tertiary:{backgroundColor:"transparent",color:"black",border:"none"}}[e]}},CloseButton:s,useBasePath:!0,basePathToUse:d,webWorkersFolderPath:d+"/web_workers_for_ws_images",iconsFolderPath:d+"/icons",idbDatabaseVersion:1},c=u},3667:(e,t,n)=>{"use strict";n.r(t),n.d(t,{calcUserHasPinchZoomed:()=>eg,default:()=>ef,useAllStudentsStore:()=>ed,useSessionStateStore:()=>eu,useUserSettingsStore:()=>ec,worksheets:()=>eh});var r=n(1047),o=n(6847);let i=e=>{let t;let n=new Set,r=(e,r)=>{let o="function"==typeof e?e(t):e;if(!Object.is(o,t)){let e=t;t=(null!=r?r:"object"!=typeof o||null===o)?o:Object.assign({},t,o),n.forEach(n=>n(t,e))}},o=()=>t,i={setState:r,getState:o,getInitialState:()=>s,subscribe:e=>(n.add(e),()=>n.delete(e))},s=t=e(r,o,i);return i},s=e=>e?i(e):i,l=e=>e,a=e=>{let t=s(e),n=e=>(function(e,t=l){let n=o.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return o.useDebugValue(n),n})(t,e);return Object.assign(n,t),n},d=e=>e?a(e):a;var u=n(3844);let c=d(e=>({aWorksheetProcessIsBusy:!1,updateValue:t=>{e(()=>({aWorksheetProcessIsBusy:t}))}})),g=d(e=>({statusMessage:"Retrieving worksheet data from your device...",setStatusMessage:t=>{e(()=>({statusMessage:t}))}})),p=d(e=>({userHasPinchZoomed:!1,setUserHasPinchZoomed:t=>{e(()=>({userHasPinchZoomed:t}))}})),h=d(e=>({addWorksheetModalIsOpen:!1,setAddWorksheetModalIsOpen:t=>{e(()=>({addWorksheetModalIsOpen:t}))},studentAddingFor:null,setStudentAddingFor:t=>{e(()=>({studentAddingFor:t}))},indexOfStudentAddingFor:null,setIndexOfStudentAddingFor:t=>{e(()=>({indexOfStudentAddingFor:t}))}})),x=d(e=>({searchInputValue:"",setSearchInputValue:t=>{["a","b","c","1","2","3","4","5","6"].includes(t.toLowerCase())&&(t="0"+t),e({searchInputValue:t});let n={0:0,"0a":0,"0b":0,"0c":0,"01":1,"02":2,"03":3,"04":4,"05":5,"06":6};if(t.length>=2)b.getState().setSearchResults(W(t));else if("0"==t){let e=[...W("0a"),...W("0b"),...W("0c")];b.getState().setSearchResults(e)}else b.getState().setSearchResults([]);if(S.getState().setHighlightedResultIndex(0),"0"==t){f.getState().setSelectedLevelInteger("0");return}if(t.length>=2){let e=t.slice(0,2).toLowerCase();if(n.hasOwnProperty(e)){f.getState().setSelectedLevelInteger(n[e]);return}}"0"!==t&&f.getState().setSelectedLevelInteger("All")}})),f=d(e=>({selectedLevelInteger:"All",setSelectedLevelInteger:t=>e({selectedLevelInteger:t})})),b=d(e=>({searchResults:[],setSearchResults:t=>{e({searchResults:t}),e({resultElementRefs:[]})},resultElementRefs:[],setResultElementRefs:t=>e({resultElementRefs:t})})),S=d(e=>({highlightedResultIndex:0,setHighlightedResultIndex:t=>{e({highlightedResultIndex:t});let{resultElementRefs:n}=b.getState();n.length>0&&n[t].scrollIntoView({behavior:"instant",block:"nearest"})}}));function w(e){let{searchResults:t}=b.getState();if(0==t.length)return;let{highlightedResultIndex:n}=S.getState(),r=n;"ArrowDown"==e.key&&(r++,e.preventDefault()),"ArrowUp"==e.key&&(r--,e.preventDefault()),r<0&&(r=t.length-1),r>=t.length&&(r=0),r!=n&&S.getState().setHighlightedResultIndex(r),"Enter"==e.key&&(P(),e.preventDefault())}function v(){let e;(0,o.useEffect)(()=>(x.getState().setSearchInputValue(""),document.addEventListener("keydown",w),window.useSelectedLevelStore=f,window.getSearchResults=W,window.searchResultsStore=b,window.useHighlightedResultIndexStore=S,()=>{document.removeEventListener("keydown",w)}),[]);let{studentAddingFor:t}=h.getState();if("other"==t)e="Other";else{let{allStudents:n}=ed.getState();e=n[t].name}return(0,r.jsxs)(u.GenericModal,{blockBehind:!0,widthSetting:"96%",heightSetting:"96%",additionalStyleObject:{boxSizing:"border-box",display:"flex",flexDirection:"column",maxWidth:"1000px",maxHeight:"700px"},children:[(0,r.jsxs)("div",{width:"100%",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[" ",(0,r.jsxs)("h1",{style:{fontFamily:"Roboto, sans-serif",fontSize:"18px",fontWeight:"normal",margin:"0"},children:["Add Worksheet for ",e]}),(0,r.jsx)(u.CloseButton,{buttonWidthString:"37px",iconWidthString:"22px",color:"black",onClickFunction:function(){h.getState().setAddWorksheetModalIsOpen(!1)},additionalStyleObject:{top:"10px",right:"10px"}})]}),(0,r.jsxs)("div",{style:{display:"flex",height:"100%"},children:[" ",(0,r.jsxs)("div",{style:{flexGrow:"1",boxSizing:"border-box",marginRight:"20px",display:"flex",flexDirection:"column",height:"100%",containerType:"size"},children:[(0,r.jsx)(m,{}),(0,r.jsx)(k,{}),(0,r.jsx)(y,{})]}),(0,r.jsx)(I,{})]})]})}function y(){let{searchResults:e}=b(),{highlightedResultIndex:t}=S(),n={width:"100%",padding:"10px 0px",borderBottom:"1px solid #D1C7C5",cursor:"pointer"},o={backgroundColor:"#EAE4D4",borderBottom:"1px solid #EAE4D4"};o={...o,...n};let i={borderTop:"1px solid #D1C7C5"};i={...i,...n};let s=e=>e==t?o:0==e?i:n,l=function(t){D(e[t],!0)},a=e=>{if(null==e)return;let{resultElementRefs:t}=b.getState();t.push(e)};return(0,r.jsx)("div",{style:{overflowY:"auto",height:"100%",boxSizing:"border-box",marginTop:"20px"},children:e.map((e,t)=>(0,r.jsx)("div",{onClick:()=>{l(t)},style:s(t),ref:a,children:e},t))})}function m(){let{searchInputValue:e}=x();return(0,r.jsxs)("div",{style:{width:"100%",height:"50px",flexShrink:"0",border:"1px solid #A9A09E",borderRadius:"200px",boxSizing:"border-box",marginTop:"20px",overflow:"hidden",display:"flex"},children:[(0,r.jsx)("input",{type:"text",placeholder:"Search a worksheet ID...",style:{color:"#3d3d3d",fontFamily:"Roboto, sans-serif",fontSize:"16px",width:"100%",height:"100%",border:"none",padding:"17px 24px",boxSizing:"border-box",outline:"none"},value:e,onChange:e=>{let t=e.target.value;x.getState().setSearchInputValue(t)}}),(0,r.jsx)(u.CloseButton,{iconWidthString:"14px",color:"black",onClickFunction:function(){let{setSearchInputValue:e}=x.getState();e("")},additionalStyleObject:{width:60,height:"100%"}})]})}function k(){return(0,r.jsxs)("div",{style:{display:"flex",gap:"8px",marginTop:"20px",flexWrap:"wrap"},children:[(0,r.jsx)(j,{levelInteger:"All"}),(0,r.jsx)(j,{levelInteger:"0"}),(0,r.jsx)(j,{levelInteger:"1"}),(0,r.jsx)(j,{levelInteger:"2"}),(0,r.jsx)(j,{levelInteger:"3"}),(0,r.jsx)(j,{levelInteger:"4"}),(0,r.jsx)(j,{levelInteger:"5"}),(0,r.jsx)(j,{levelInteger:"6"})]})}function j(e){let{levelInteger:t}=e,{selectedLevelInteger:n}=f(),o="Lvl "+t;"All"==t&&(o="All");let i={padding:"9px 14px",margin:"0",border:"2px solid #DAD6D5",fontWeight:"normal"};return n==t&&(i.backgroundColor="#E6E6EB"),(0,r.jsx)(u.GenericPillButton,{isFilled:!1,isShort:!0,additionalStyleObject:i,functionToTrigger:()=>{f.getState().setSelectedLevelInteger(t),"All"==t?x.getState().setSearchInputValue(""):"0"==t?x.getState().setSearchInputValue("0"):x.getState().setSearchInputValue("0"+t)},children:o})}function C(e){let t,{val:n}=e,o={backgroundColor:"white",border:"1px solid #DAD6D5",boxShadow:"0px 1px 4px #0000001a",width:"55px",height:"55px",color:"#3D3D3D",borderRadius:"10px",fontFamily:"Roboto, sans-serif",fontSize:"30px",display:"flex",alignItems:"center",justifyContent:"center"},i=function(e){if("clear"==e){x.getState().setSearchInputValue("");return}if("backspace"==e){let{searchInputValue:e,setSearchInputValue:t}=x.getState();t(e.slice(0,-1));return}if("open"==e){P();return}let t=x.getState().searchInputValue;x.getState().setSearchInputValue(t+e)},s={width:"63px",height:"63px",display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer",backgroundColor:"white",border:"none",padding:"0px",userSelect:"none"};"backspace"==n?t=(0,r.jsx)("img",{src:u.default.iconsFolderPath+"/backspace.svg",alt:"Backspace",style:{width:"26px",height:"26px"}}):"clear"==n?(t="Clear",o.backgroundColor=u.default.redColor,o.color="white",o.fontSize="20px"):"open"==n?(t="Open",s.width="100px",o.width="100%",o.backgroundColor="#eae4d444",o.border="1px solid rgb(204, 194, 166)",o.fontSize="20px"):t=n;let l=!1;return"open"==n&&(l=0==b().searchResults.length),l&&(o.backgroundColor="#EBEBEB",o.border="none",o.color="#8c8c8c",s.cursor="not-allowed"),(0,r.jsx)(u.PressDownButton,{style:s,functionToTrigger:()=>{i(n)},disabled:l,children:(0,r.jsx)("div",{style:o,children:t})})}function I(){let e={display:"flex",justifyContent:"center"};return(0,r.jsxs)("div",{style:{margin:"auto 0"},children:[(0,r.jsxs)("div",{style:e,children:[(0,r.jsx)(C,{val:"A"}),(0,r.jsx)(C,{val:"B"}),(0,r.jsx)(C,{val:"C"})]}),(0,r.jsxs)("div",{style:e,children:[(0,r.jsx)(C,{val:"1"}),(0,r.jsx)(C,{val:"2"}),(0,r.jsx)(C,{val:"3"})]}),(0,r.jsxs)("div",{style:e,children:[(0,r.jsx)(C,{val:"4"}),(0,r.jsx)(C,{val:"5"}),(0,r.jsx)(C,{val:"6"})]}),(0,r.jsxs)("div",{style:e,children:[(0,r.jsx)(C,{val:"7"}),(0,r.jsx)(C,{val:"8"}),(0,r.jsx)(C,{val:"9"})]}),(0,r.jsxs)("div",{style:{display:"flex",justifyContent:"center",marginBottom:"20px"},children:[(0,r.jsx)(C,{val:"backspace"}),(0,r.jsx)(C,{val:"0"}),(0,r.jsx)(C,{val:"clear"})]}),(0,r.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:(0,r.jsx)(C,{val:"open"})})]})}function W(e){let t=e.toUpperCase().replace(/[^0-9A-Z]/gi,"");if(t.length<2)return[];let n=t.toUpperCase().slice(0,2).replace(/[^0-9ABC]/gi,"")+t.toUpperCase().slice(2).replace(/[^0-9]/gi,""),r=e.toUpperCase().replace(/[^A-Z]/gi,""),o=[],i=(e,t)=>{if(e.includes("(OLD)")&&!t.includes("(OLD)"))return 1;if(!e.includes("(OLD)")&&t.includes("(OLD)"))return -1;let n=e.toUpperCase().replace(/[^A-Z]/gi,"").includes(r),o=t.toUpperCase().replace(/[^A-Z]/gi,"").includes(r);return n&&!o?-1:!n&&o||e.includes("(USA)")&&!t.includes("(USA)")?1:!e.includes("(USA)")&&t.includes("(USA)")?-1:0};worksheets.integerMap[n]&&(o=worksheets.integerMap[n]),o.sort(i);let s=[];for(let e in worksheets.integerMap)e.startsWith(n)&&worksheets.integerMap[e].forEach(e=>{o.includes(e)||s.push(e)});return s.sort(i),[...o,...s]}function D(e,t){let n;let{indexOfStudentAddingFor:r}=h.getState(),{openStudents:o}=eu.getState(),i=o[r],s=function(e,t){for(let n in t)if(t[n].id==e)return n;return null}(e,i.openWorksheets);null==s?(i.openWorksheets.push({id:e,pageLeftOff:0}),n=i.openWorksheets.length-1):n=s,eu.getState().setCurrentWorksheet(r,n),t&&h.getState().setAddWorksheetModalIsOpen(!1)}function P(){let{searchResults:e}=b.getState();if(0==e.length)return;let{highlightedResultIndex:t}=S.getState();D(e[t],!0)}let A=d(e=>({pagesAreHidden:!1,setPagesAreHidden:t=>e({pagesAreHidden:t})})),O=d(e=>({userIsDraggingPages:!1,touchStartX:null,currentPageOnTouchStart:null})),R=function(){let{userHasPinchZoomed:e}=p.getState(),{pagesAreHidden:t}=A.getState(),{currentWorksheet:n}=eu.getState();return!e&&!t&&null!=n.worksheetIndex};function B(e){let{allowArrowKeysForPageNavigation:t}=eu.getState();t&&("ArrowLeft"==e.key&&_("prev"),"ArrowRight"==e.key&&_("next"))}function L(e){let t=R();if(!t)return;t&&e.preventDefault();let n=e.touches?e.touches[0].clientX:e.clientX;O.setState({userIsDraggingPages:!0,currentPageOnTouchStart:eu.getState().currentPageOfWorksheet,touchStartX:n})}function F(e){let{userIsDraggingPages:t,touchStartX:n,currentPageOnTouchStart:r}=O.getState();if(!t)return;let{setCurrentPageOfWorksheet:o,getCurrentWorksheetID:i}=eu.getState();e.preventDefault();let s=-1*Math.round(((e.touches?e.touches[0].clientX:e.clientX)-n)/60),{pageView:l}=ec.getState();"double"==l&&(s*=2);let a=r+s,d="single"==l?1:0,u=eh[i()].pageCount;"double"==l&&u%2==1&&(u-=1),a<d&&(a=d),a>u&&(a=u);let{currentPageOfWorksheet:c}=eu.getState();a!==c&&o(a)}function T(e){let{userIsDraggingPages:t}=O.getState();t&&(e.preventDefault(),O.setState({userIsDraggingPages:!1,currentPageOnTouchStart:null,touchStartX:null}))}function E(){let e=c().aWorksheetProcessIsBusy,t=g().statusMessage,{pageView:n}=ec(),o=null,i={width:"100%",height:"100%",containerType:"size",boxSizing:"border-box",display:"flex"};return e?o=(0,r.jsx)("div",{id:"wrapper-for-both-pages",style:i,children:(0,r.jsx)("p",{children:t})}):("double"==n&&(o=(0,r.jsxs)("div",{id:"wrapper-for-both-pages",style:i,children:[(0,r.jsx)("div",{id:"wrapper-for-single-page",style:{position:"relative",width:"50%",marginRight:"".concat(16,"px"),height:"100%"},children:(0,r.jsx)(M,{isLeftOrRight:"left"})}),(0,r.jsx)("div",{id:"wrapper-for-single-page",style:{position:"relative",width:"50%",height:"100%"},children:(0,r.jsx)(M,{isLeftOrRight:"right"})})]})),"single"==n&&(o=(0,r.jsx)("div",{id:"wrapper-for-both-pages",style:i,children:(0,r.jsx)("div",{id:"wrapper-for-single-page",style:{position:"relative",width:"100%",height:"100%"},children:(0,r.jsx)(M,{isLeftOrRight:"left"})})}))),(0,r.jsxs)("div",{style:{flexGrow:1,flexBasis:"0%",height:"100%",padding:"16px",paddingRight:"8px",boxSizing:"border-box",display:"flex",flexDirection:"column",containerType:"size"},children:[o,(0,r.jsx)(z,{})]})}function _(e){let{currentPageOfWorksheet:t,setCurrentPageOfWorksheet:n,getCurrentWorksheetID:r}=eu.getState();if(null==r())return;let{pageView:o}=ec.getState(),i="single"==o?1:2,s=r(),l=t;"prev"==e&&(l-=i),"next"==e&&(l+=i);let a="single"==o?1:0,d=eh[s].pageCount;"double"==o&&d%2==1&&(d-=1),l<a&&(l=a),l>d&&(l=d),n(l)}function z(){let{pageView:e}=ec(),t=u.default.iconsFolderPath+("single"==e?"/single_page_view.svg":"/two_page_view.svg"),n=(0,r.jsx)(u.GenericPillButton,{isFilled:!0,isShort:!0,additionalStyleObject:{paddingLeft:"min(1.5vw, 24px)",paddingRight:"min(1.5vw, 24px)",minWidth:"45px"},functionToTrigger:function(){let{pageView:e,setPageView:t}=ec.getState(),n="double"==e?"single":"double";t(n);let{currentPageOfWorksheet:r,setCurrentPageOfWorksheet:o}=eu.getState(),i=r;"single"==n&&0==i&&(i=1),"double"==n&&i%2==1&&i--,o(i)},children:(0,r.jsx)("img",{src:t,alt:"Toggle Page View"})}),o=(0,r.jsxs)(u.GenericPillButton,{isFilled:!1,isShort:!0,additionalStyleObject:{paddingLeft:"min(1.5vw, 24px)",paddingRight:"min(1.5vw, 24px)"},functionToTrigger:K,useOnClick:!0,children:[(0,r.jsx)("p",{style:{margin:"0",padding:"0",marginRight:"10px",fontSize:"min(1.6vw, 16px)",textWrap:"nowrap"},children:"Move"}),(0,r.jsx)("img",{src:u.default.iconsFolderPath+"/move.svg",alt:"Move",style:{width:"19px",height:"15px"}})]}),i=(0,r.jsxs)(u.GenericPillButton,{isFilled:!0,isShort:!0,additionalStyleObject:{paddingLeft:"min(1.5vw, 24px)",paddingRight:"min(1.5vw, 24px)",zIndex:"2"},functionToTrigger:()=>{console.log("log worksheet button clicked")},children:[(0,r.jsx)("p",{style:{margin:"0",padding:"0",marginRight:"14px",fontSize:"min(1.6vw, 16px)",textWrap:"nowrap"},children:"Log worksheet"}),(0,r.jsx)("img",{src:u.default.iconsFolderPath+"/arrow_up.svg",alt:"Expand",style:{width:"14px",height:"7px"}})]}),{pagesAreHidden:s}=A(),l=(0,r.jsx)(u.GenericPillButton,{isFilled:!0,isShort:!0,additionalStyleObject:{paddingLeft:"min(2vw, 30px)",paddingRight:"min(2vw, 30px)"},functionToTrigger:function(){let{pagesAreHidden:e,setPagesAreHidden:t}=A.getState();t(!e)},children:s?(0,r.jsx)("img",{id:"toggle-hidden",src:u.default.iconsFolderPath+"/hidden.svg",alt:"Toggle visibility"}):(0,r.jsx)("img",{id:"toggle-visible",src:u.default.iconsFolderPath+"/visible.svg",alt:"Toggle visibility"})}),a=(0,r.jsx)(u.GenericPillButton,{isFilled:!1,isShort:!0,additionalStyleObject:{paddingLeft:"min(2vw, 30px)",paddingRight:"min(2vw, 30px)",zIndex:"2"},functionToTrigger:()=>{_("prev")},children:(0,r.jsx)("img",{src:u.default.iconsFolderPath+"/arrow_left.svg",alt:"Previous Page",style:{width:"15px",height:"20px"}})}),d=(0,r.jsx)(u.GenericPillButton,{isFilled:!1,isShort:!0,additionalStyleObject:{paddingLeft:"min(2vw, 30px)",paddingRight:"min(2vw, 30px)",zIndex:"2"},functionToTrigger:()=>{_("next")},children:(0,r.jsx)("img",{src:u.default.iconsFolderPath+"/arrow_right.svg",alt:"Next Page",style:{width:"15px",height:"20px"}})}),c={display:"flex",gap:"8px"};return(0,r.jsxs)("div",{style:{paddingTop:"16px",display:"flex",gap:"8px",justifyContent:"space-between"},children:[(0,r.jsxs)("div",{style:c,children:[n,l,o,i]}),(0,r.jsxs)("div",{style:c,children:[a,d]})]})}function M(e){let{isLeftOrRight:t}=e,n=(0,o.useRef)(null);(0,o.useEffect)(()=>(n.current.addEventListener("pointerdown",L),()=>{n.current&&n.current.removeEventListener("pointerdown",L)}),[]);let i=p(e=>e.userHasPinchZoomed),s=A(e=>e.pagesAreHidden),l=eu(e=>e.currentWorksheet),a=!i&&!s&&null!=l.worksheetIndex,{currentPageOfWorksheet:d,getCurrentWorksheetID:u}=eu(),c="left"==t?d:d+1,g=null,h=u();return h&&(eh[h]?eh[h].pageBlobs[c]&&(g=eh[h].pageBlobs[c]):g="worksheet_not_available"),(0,r.jsxs)("div",{style:{position:"absolute",inset:0,marginLeft:"auto",maxHeight:"100%",aspectRatio:"496 / 702",cursor:a?"ew-resize":"default",userSelect:"none"},ref:n,children:[(0,r.jsx)(N,{pageImageBlob:g}),(0,r.jsx)(V,{isLeftOrRight:t,pageNumber:c,pageExists:null===g})]})}function V(e){let{isLeftOrRight:t,pageNumber:n,pageExists:o}=e,i={position:"absolute",bottom:"15px",width:"44px",height:"44px",backgroundColor:"white",borderRadius:"4px",border:"1px solid #3D3D3D",justifyContent:"center",alignItems:"center",fontSize:"18px",display:o?"none":"flex"};return i[t]="15px",(0,r.jsx)("div",{style:i,children:n})}function N(e){let{pageImageBlob:t}=e,n={width:"100%",height:"100%",border:"1px solid #A9A09E",borderRadius:"12px",backgroundColor:"white",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",boxSizing:"border-box"},{pagesAreHidden:o}=A();if(null===t||o)return(0,r.jsx)("div",{style:n});if("worksheet_not_available"===t)return(0,r.jsxs)("div",{style:n,children:[(0,r.jsx)("p",{style:{fontSize:"14px",textWrap:"balance",textAlign:"center"},children:"Error"}),(0,r.jsx)("p",{style:{fontSize:"14px",textWrap:"balance",textAlign:"center"},children:"It appears this worksheet is not downloaded to your system."})]});let i=URL.createObjectURL(t);return(0,r.jsx)("img",{src:i,style:n,draggable:!1,onDragStart:e=>e.preventDefault()})}function U(){let e={width:u.default.worksheetSelectionPanelWidth,height:"100%",padding:"16px",paddingLeft:"8px",boxSizing:"border-box",overflowY:"scroll",containerType:"size"},t=eu().openStudents;return(0,o.useEffect)(()=>{window.openStudents=t},[]),(0,r.jsxs)("div",{style:{height:"100%",flexGrow:0,flexBasis:"0%",display:"flex",flexDirection:"column"},children:[(0,r.jsxs)("div",{style:e,children:[t.map((e,t)=>(0,r.jsx)(H,{index:t,studentIDNumber:e.studentIDNumber},e.studentIDNumber)),(0,r.jsx)(Q,{})]}),(0,r.jsx)(G,{})]})}function G(){let e=(0,r.jsx)(u.GenericPillButton,{isFilled:!1,isShort:!0,additionalStyleObject:{paddingLeft:"min(1.5vw, 24px)",paddingRight:"min(1.5vw, 24px)"},functionToTrigger:()=>{console.log("view log button clicked")},children:(0,r.jsx)("p",{style:{margin:"0",padding:"0",fontSize:"min(1.6vw, 16px)",textWrap:"nowrap"},children:"View log"})}),t=(0,r.jsx)(u.GenericPillButton,{isFilled:!1,isShort:!0,additionalStyleObject:{paddingLeft:"min(1.5vw, 30px)",paddingRight:"min(1.5vw, 30px)"},functionToTrigger:()=>{eu.getState().setCurrentPage("SettingsPage")},children:(0,r.jsx)("img",{src:u.default.iconsFolderPath+"/settings.svg",alt:"Settings",style:{width:"23px",height:"23px"}})});return(0,r.jsxs)("div",{style:{paddingTop:"16px",display:"flex",justifyContent:"flex-end",gap:"8px",marginBottom:"16px",marginRight:"16px",borderTop:"1px solid #A9A09E"},children:[e,t]})}function H(e){let t,{studentIDNumber:n,index:o}=e,{allStudents:i}=ed.getState();t="other"==n?{name:"Other",color:"none"}:i[n];let s={width:"100%",backgroundColor:"white",borderRadius:"12px",boxShadow:"0px 1px 2px rgba(0, 0, 0, 0.45)",boxSizing:"border-box",marginBottom:"12px",overflow:"hidden",position:"relative"};return"other"==n&&(s.border="1px solid #eeeeee"),(0,r.jsxs)("div",{style:s,children:[(0,r.jsx)(ee,{index:o,studentName:t.name,studentIDNumber:n}),(0,r.jsx)(X,{studentIDNumber:n}),(0,r.jsx)(q,{studentIDNumber:n,index:o})]})}function Z(e){let t=eu.getState().openStudents;return{thisStudent:t.filter(t=>t.studentIDNumber==e)[0],thisStudentIndex:t.findIndex(t=>t.studentIDNumber==e)}}function X(e){let{studentIDNumber:t}=e,{allStudents:n}=ed.getState(),{openStudents:o,currentWorksheet:i}=eu(),s={display:"flex",flexDirection:"column",padding:"10px 4px",overflowY:"auto",height:"100%"};"other"==t&&(s.paddingTop="0px");let{thisStudent:l,thisStudentIndex:a}=Z(t),d=[];for(let e=0;e<l.openWorksheets.length;e++){let t=l.openWorksheets[e].id,n=i.openStudentIndex==a&&i.worksheetIndex==e,o=function(){let{setCurrentWorksheet:t,setUserIsMovingCurrentWorksheet:n,setCurrentPageOfWorksheet:r,openStudents:o}=eu.getState(),{pageView:i}=ec.getState();t(a,e),n(!1);let s=o[a].openWorksheets[e].pageLeftOff;"single"==i&&0==s&&(s=1),"double"==i&&s%2==1&&s--,r(s)};d.push((0,r.jsx)(Y,{worksheetID:t,isCurrentWorksheet:n,onClick:o},e))}return(0,r.jsx)("div",{style:s,children:d})}function Y(e){let{worksheetID:t,isCurrentWorksheet:n,onClick:o}=e,i={fontFamily:"Roboto, sans-serif",fontWeight:"normal",fontSize:"12px",border:"none",backgroundColor:"white",padding:"6px",cursor:n?"arrow":"pointer",textAlign:"left",width:"100%",borderRadius:"12px",color:"inherit",boxSizing:"border-box",display:"flex",justifyContent:"space-between",alignItems:"center"},s=t.replace(/( WS|WS)$/,"");return n?(i.backgroundColor="#55587B26",(0,r.jsxs)("div",{style:i,children:[(0,r.jsx)("p",{style:{margin:0,whiteSpace:n?"normal":"nowrap",overflow:"hidden",textOverflow:"ellipsis",flexShrink:1},children:s}),(0,r.jsx)("div",{style:{display:"flex"},children:(0,r.jsx)(u.CloseButton,{buttonWidthString:"24px",iconWidthString:"14px",color:"black",onClickFunction:function(){let e=eu.getState().currentWorksheet;eu.getState().openStudents[e.openStudentIndex].openWorksheets.splice(e.worksheetIndex,1),eu.getState().setCurrentWorksheet(null,null),eu.getState().setUserIsMovingCurrentWorksheet(!1)},additionalStyleObject:{flexShrink:0}})})]})):(0,r.jsx)("button",{style:i,onClick:o,children:s})}function K(){let{userIsMovingCurrentWorksheet:e,setUserIsMovingCurrentWorksheet:t,setUserCanClickAnywhereToDisableMovingCurrentWorksheet:n,currentWorksheet:r}=eu.getState();null!==r.openStudentIndex&&(e||n(!0),t(!e))}function q(e){let{studentIDNumber:t,index:n}=e,o={backgroundColor:"white",border:"2px solid ".concat(u.default.softBorderColor),borderRadius:"50%",cursor:"pointer",width:"40px",height:"40px",verticalAlign:"middle",display:"flex",alignItems:"center",justifyContent:"center"};return(0,r.jsxs)("div",{style:{backgroundColor:"none",padding:"14px 14px",paddingTop:"0px",justifyContent:"space-between",alignItems:"center",display:"flex"},children:[(0,r.jsx)(J,{styleObject:o,studentIDNumber:t}),(0,r.jsx)($,{styleObject:o,studentIDNumber:t,index:n})]})}function J(e){let{studentIDNumber:t,styleObject:n}=e;return(0,r.jsx)("button",{style:n,children:(0,r.jsx)("img",{src:u.default.iconsFolderPath+"/timer.svg",alt:"Start timer",style:{width:"23px",height:"23px"}})})}function $(e){let{studentIDNumber:t,styleObject:n,index:o}=e;return(0,r.jsx)("button",{style:n,onClick:function(){h.getState().setAddWorksheetModalIsOpen(!0),h.getState().setStudentAddingFor(t),h.getState().setIndexOfStudentAddingFor(o)},children:(0,r.jsx)("img",{src:u.default.iconsFolderPath+"/add_black.svg",alt:"Add worksheet",style:{width:"16px",height:"16px"}})})}function Q(){return(0,r.jsxs)(u.GenericPillButton,{useOnClick:!0,isFilled:!0,isShort:!0,functionToTrigger:()=>{console.log("Add student")},additionalStyleObject:{margin:"0 auto",paddingLeft:"30px",paddingRight:"30px"},children:[(0,r.jsx)("img",{src:u.default.iconsFolderPath+"/add_white.svg",alt:"Add student",style:{width:"12px",height:"12px",marginRight:"8px"}}),(0,r.jsx)("p",{style:{margin:"0",padding:"0"},children:"Add Students"})]})}function ee(e){let t,{studentName:n,studentIDNumber:o,index:i}=e,{allStudents:s}=ed.getState(),{userIsMovingCurrentWorksheet:l,openStudents:a,currentWorksheet:d}=eu.getState();t="other"==o?{name:"Other",color:"none"}:s[o];let c={display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:u.default.redColor,padding:"6px 10px","--original-bg-color":u.default.redColor,"--pulsate-bg-color":"#eb9286"};l&&(c.cursor="pointer");let g={margin:0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"white",fontWeight:"normal",fontSize:"12px"},p={width:"18px",height:"18px",borderRadius:"50%",backgroundColor:u.default.colorMap[t.color],marginRight:"10px"};"other"==o&&(p.backgroundColor="#00000000",c.backgroundColor="white",c.justifyContent="center",c.padding="10px 0px",c["--original-bg-color"]="rgb(223, 223, 223)",c["--pulsate-bg-color"]="white",g.color="black");let h=(0,r.jsx)(u.CloseButton,{buttonWidthString:"24px",iconWidthString:"14px",color:"white",onClickFunction:()=>{let{deleteOpenStudent:e}=eu.getState();e(o)}});return l&&(h=(0,r.jsx)("div",{style:{width:"24px",height:"24px"}})),"other"==o&&(h=null),(0,r.jsxs)("div",{style:c,className:l?"pulsatingHeader":null,onClick:l?function(){let{thisStudentIndex:e}=Z(o),{setOpenStudents:t,setCurrentWorksheet:n}=eu.getState();if(e!==d.openStudentIndex){let r=[...a];r[e].openWorksheets.push(a[d.openStudentIndex].openWorksheets[d.worksheetIndex]),a[d.openStudentIndex].openWorksheets.splice(d.worksheetIndex,1),t(r),n(e,r[e].openWorksheets.length-1)}}:null,children:[(0,r.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:["other"==o?null:(0,r.jsx)("div",{style:p}),(0,r.jsx)("h1",{style:g,children:n})]}),h]})}function et(e){g.getState().setStatusMessage(e)}function en(){let e=u.default.getGenericButtonStyle("primary"),t=o.useRef(null),n=c().aWorksheetProcessIsBusy,i=async function(e){if(0===e.target.files.length)return;let t=e.target.files[0];(function(e){for(let t in e){let n=t.split("_-")[0],r=Number(t.split("_-")[1].split(".")[0]);if(eh[n])eh[n].pageBlobs[r]=e[t].blob;else{let o={};o[r]=e[t].blob,eh[n]={pageBlobs:o,is_old:t.includes("(OLD)"),localization:t.includes("(USA)")?"USA":"only",pageCount:"unknown"}}}(function(){for(let e in eh)"only"==eh[e].localization&&function(e){let t=e.replace(/\D/g,"");for(let e in eh){let n=e.replace(/\D/g,"");if(e.includes("(USA)")&&n==t)return!0}return!1}(e)&&(eh[e].localization="NON-USA"),eh[e].pageCount=Object.keys(eh[e].pageBlobs).length})()})(await er(t)),function(){let e=new Worker(u.default.webWorkersFolderPath+"/worker_for_store_files_in_idb.js"),t={worksheets:eh,idbDatabaseVersion:u.default.idbDatabaseVersion};e.postMessage(t),e.onmessage=function(e){"status_update_from_web_worker"==e.data.type&&et(e.data.content),"confirm_transaction_complete"==e.data.type&&c.getState().updateValue(!1)},c.getState().updateValue(!0)}()};return(0,r.jsxs)("div",{children:[(0,r.jsx)("button",{style:e,onClick:()=>{n||t.current.click()},disabled:n,className:"button-with-disabled-variant",children:"Upload Worksheet Image Data"}),(0,r.jsx)("input",{type:"file",style:{display:"none"},ref:t,accept:".tar",onChange:i})]})}async function er(e){et("Extracting images from tar file...");let t=new FileReader,n={},r=0;return new Promise((o,i)=>{t.onload=function(e){untar(t.result).then(function(e){for(let t in e){let o=e[t].name.substring(e[t].name.lastIndexOf("/")+1);if(o.includes(".webp")){let i={name:o,blob:new Blob([e[t].blob],{type:"image/webp"}),size:e[t].size};n[o]=i,r++}else console.log("File not a webp image: "+o)}et(r+" images extracted. Storing worksheets on your device..."),o(n)}).catch(i)},t.onerror=i,t.readAsArrayBuffer(e)})}function eo(){let e=u.default.getGenericButtonStyle("primary"),t=c().aWorksheetProcessIsBusy;return(0,r.jsx)("button",{style:e,onClick:function(){t||ei(!0)},disabled:t,className:"button-with-disabled-variant",children:"Retrieve Worksheet Image Data"})}function ei(e){c.getState().updateValue(!0);let t=new Worker(u.default.webWorkersFolderPath+"/worker_for_retrieve_files_from_idb.js"),n={idbDatabaseVersion:u.default.idbDatabaseVersion};t.postMessage(n),t.onmessage=function(e){if("status_update_from_web_worker"==e.data.type&&et(e.data.content),"worksheets_from_idb"==e.data.type){for(let e in eh)eh.hasOwnProperty(e)&&delete eh[e];Object.assign(eh,e.data.content),eh.keys=Object.keys(eh),window.worksheets=eh,eh.integerMap=function(){let e=Object.keys(eh),t={};for(let n=0;n<e.length;n++){if("keys"==e[n])continue;let r=e[n].split(" "),o="";for(let e=0;e<r.length;e++)(r[e].includes(".")||r[e].includes("-"))&&(o+=r[e].replace(/[^0-9ABC]/g,""));t.hasOwnProperty(o)?t[o].push(e[n]):t[o]=[e[n]]}return t}(),c.getState().updateValue(!1)}}}function es(){let e=u.default.getGenericButtonStyle("primary"),t=c().aWorksheetProcessIsBusy;return(0,r.jsx)("button",{style:e,onClick:function(){let e;t||((e=indexedDB.open("worksheetDatabase",u.default.idbDatabaseVersion)).onupgradeneeded=function(e){e.target.result.createObjectStore("allWorksheets")},e.onsuccess=async function(e){e.target.result.transaction("allWorksheets","readwrite").objectStore("allWorksheets").clear()},et("Worksheet image data cleared."))},disabled:t,className:"button-with-disabled-variant",children:"Clear Worksheet Image Data"})}function el(){let e=g().statusMessage;return(0,r.jsx)("p",{style:{whiteSpace:"pre-wrap"},children:e})}let ea={WorksheetViewer:(0,r.jsx)(function(){(0,o.useEffect)(()=>(window.useAddWorksheetModalIsOpenStore=h,window.usePageDraggingStore=O,document.addEventListener("keydown",B),document.addEventListener("pointermove",F),document.addEventListener("pointerup",T),()=>{document.removeEventListener("keydown",B),document.removeEventListener("pointermove",F),document.removeEventListener("pointerup",T)}),[]);let{addWorksheetModalIsOpen:e}=h(),t=O(e=>e.userIsDraggingPages);return(0,r.jsxs)("div",{style:{width:"100%",height:"100%",display:"flex",flexShrink:0,containerType:"size",cursor:t?"ew-resize":"default"},children:[(0,r.jsx)(E,{}),(0,r.jsx)(U,{}),e?(0,r.jsx)(v,{}):null]})},{}),SettingsPage:(0,r.jsx)(function(){let e=(0,r.jsx)(u.CloseButton,{buttonWidthString:"24px",iconWidthString:"14px",color:"black",onClickFunction:()=>{useSessionStateStore.getState().setCurrentPage("WorksheetViewer")},additionalStyleObject:{position:"absolute",top:"18px",right:"18px"}});return(0,r.jsxs)("div",{style:{width:"100%",height:"100%",boxSizing:"border-box",padding:"16px"},children:[(0,r.jsx)("h1",{children:"Settings"}),e,(0,r.jsx)(en,{}),(0,r.jsx)("br",{}),(0,r.jsx)(eo,{}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)(es,{}),(0,r.jsx)("br",{}),(0,r.jsx)("br",{}),(0,r.jsx)(el,{})]})},{})},ed=d(function(e){let t=function(){let e=localStorage.getItem("allStudents");return null!==e?{allStudents:JSON.parse(e)}:{allStudents:{}}};return{allStudents:{},initAllStudents:()=>{e(t)},setAllStudents:t=>{e({allStudents:t})}}});ed.getState().setAllStudents({1:{name:"Sidon",color:"pink"},2:{name:"Yunobo",color:"purple"},3:{name:"Tulin",color:"blue"}});let eu=d(e=>({openStudents:[{openWorksheets:[{id:"(OLD) 03.01-05 HF (USA) 1-1 WS",pageLeftOff:0},{id:"(OLD) 03.06-12 TP (USA) 1-1 WS",pageLeftOff:0}],studentIDNumber:"1"},{openWorksheets:[],studentIDNumber:"2"},{openWorksheets:[],studentIDNumber:"3"},{openWorksheets:[],studentIDNumber:"other"}],setOpenStudents:t=>{e(()=>({openStudents:t}))},deleteOpenStudent:t=>{let{currentWorksheet:n}=eu.getState(),r=eu.getState().openStudents[n.openStudentIndex].studentIDNumber;console.log({studentIDNumberOfOpenStudent:r});let o=eu.getState().openStudents.filter(e=>e.studentIDNumber!==t);e(()=>({openStudents:o}));let i=o.findIndex(e=>e.studentIDNumber===r);-1===i?e(()=>({currentWorksheet:{openStudentIndex:null,worksheetIndex:null}})):e(()=>({currentWorksheet:{openStudentIndex:i,worksheetIndex:n.worksheetIndex}}))},addOpenStudentToBottom:t=>{let n=eu.getState().openStudents.concat({openWorksheets:[],studentIDNumber:t});e(()=>({openStudents:n}))},currentPage:"WorksheetViewer",setCurrentPage:t=>{e(()=>({currentPage:t}))},currentWorksheet:{openStudentIndex:null,worksheetIndex:null},setCurrentWorksheet:(t,n)=>{e(()=>({currentWorksheet:{openStudentIndex:t,worksheetIndex:n}}))},getCurrentWorksheetID:()=>{let{openStudents:e,currentWorksheet:t}=eu.getState();return null===t.openStudentIndex||null===t.worksheetIndex?null:e[t.openStudentIndex].openWorksheets[t.worksheetIndex].id},userIsMovingCurrentWorksheet:!1,setUserIsMovingCurrentWorksheet:t=>{e(()=>({userIsMovingCurrentWorksheet:t}))},userCanClickAnywhereToDisableMovingCurrentWorksheet:!1,setUserCanClickAnywhereToDisableMovingCurrentWorksheet:t=>{e(()=>({userCanClickAnywhereToDisableMovingCurrentWorksheet:t}))},currentPageOfWorksheet:0,setCurrentPageOfWorksheet:t=>{e(()=>({currentPageOfWorksheet:t}));let{openStudents:n,currentWorksheet:r}=eu.getState();null!==r.openStudentIndex&&null!==r.worksheetIndex&&(n[r.openStudentIndex].openWorksheets[r.worksheetIndex].pageLeftOff=t,e({openStudents:[...n]}))},allowArrowKeysForPageNavigation:!0,setAllowArrowKeysForPageNavigation:t=>{e(()=>({allowArrowKeysForPageNavigation:t}))}})),ec=d(e=>({pageView:"double",setPageView:t=>{e(()=>({pageView:t}))}}));function eg(){return 1!==window.visualViewport.scale}function ep(){eg()&&!p.getState().userHasPinchZoomed&&p.getState().setUserHasPinchZoomed(!0)}let eh={},ex=function(){!function e(t){let n=eg();p.getState().userHasPinchZoomed!==n&&p.getState().setUserHasPinchZoomed(n),t&&setTimeout(e(!1),1e3)}(!1)},ef=function(){let{userHasPinchZoomed:e}=p(),{pageView:t}=ec();(0,o.useEffect)(()=>(window.visualViewport.addEventListener("resize",ep),document.addEventListener("touchend",ex),document.addEventListener("mouseup",ex),ep(),()=>{window.visualViewport.removeEventListener("resize",ep),document.removeEventListener("touchend",ex),document.removeEventListener("mouseup",ex)}),[]);let n={fontFamily:"Roboto, sans-serif",fontWeight:"normal",fontSize:"18px",height:"100%",width:"100%",maxWidth:"double"==t?"1500px":"1000px",color:u.default.nearBlackColor,touchAction:e?"auto":"pinch-zoom",margin:"0 auto"},i=eu(),s=i.currentPage;return(0,o.useEffect)(()=>{window.useAllStudentsStore=ed,window.useSessionStateStore=eu,window.useUserSettingsStore=ec,ei()},[]),(0,r.jsx)("div",{style:n,onClick:function(){"WorksheetViewer"==s&&i.userIsMovingCurrentWorksheet&&i.userCanClickAnywhereToDisableMovingCurrentWorksheet&&(i.setUserIsMovingCurrentWorksheet(!1),i.setUserCanClickAnywhereToDisableMovingCurrentWorksheet(!1))},children:ea[s]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[721,59,358],()=>t(4643)),_N_E=e.O()}]);