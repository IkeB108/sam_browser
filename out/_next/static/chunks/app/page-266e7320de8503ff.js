(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{4643:(e,t,n)=>{Promise.resolve().then(n.bind(n,8761))},8761:(e,t,n)=>{"use strict";n.r(t),n.d(t,{calcUserHasPinchZoomed:()=>K,default:()=>ee,useAllStudentsStore:()=>Y,useSessionStateStore:()=>J,useUserSettingsStore:()=>q,worksheets:()=>X});var i=n(1047),o=n(6847);let s=e=>{let t;let n=new Set,i=(e,i)=>{let o="function"==typeof e?e(t):e;if(!Object.is(o,t)){let e=t;t=(null!=i?i:"object"!=typeof o||null===o)?o:Object.assign({},t,o),n.forEach(n=>n(t,e))}},o=()=>t,s={setState:i,getState:o,getInitialState:()=>r,subscribe:e=>(n.add(e),()=>n.delete(e))},r=t=e(i,o,s);return s},r=e=>e?s(e):s,l=e=>e,d=e=>{let t=r(e),n=e=>(function(e,t=l){let n=o.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return o.useDebugValue(n),n})(t,e);return Object.assign(n,t),n},a=e=>e?d(e):d;function c(e){let{children:t,onClickFunction:n,isFilled:o,isShort:s,additionalStyleObject:r}=e,l=s?"10px":"14px",d={borderRadius:"200px",paddingTop:l,paddingBottom:l,paddingLeft:"24px",paddingRight:"24px",display:"flex",alignItems:"center",justifyContent:"center",border:o?"none":"1px solid #3d3d3d",backgroundColor:o?h.purpleColor:"white",color:o?"white":"#3d3d3d",fontFamily:"Roboto, sans-serif",fontWeight:500,fontSize:"16px",cursor:"pointer"};return r&&Object.assign(d,r),(0,i.jsx)("button",{style:d,onClick:n,children:t})}function u(e){let{buttonWidthString:t,iconWidthString:n,color:o,onClickFunction:s,additionalStyleObject:r}=e,l={background:"none",border:"none",cursor:"pointer",width:t,height:t,padding:"0px",verticalAlign:"middle",display:"flex",alignItems:"center",justifyContent:"center",boxSizing:"border-box"};return r&&Object.assign(l,r),(0,i.jsx)("button",{style:l,onClick:s,children:(0,i.jsx)("img",{src:"".concat(h.iconsFolderPath,"/close_").concat(o,".svg"),alt:"Close",style:{width:n,height:n}})})}function p(e){let{widthSetting:t,heightSetting:n,children:o,additionalStyleObject:s,blockBehind:r}=e,l={position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:t,height:n,backgroundColor:"white",boxShadow:"0 4px 8px rgba(0, 0, 0, 0.45)",zIndex:3,overflow:"auto",padding:"20px",borderRadius:"24px"};return(s&&Object.assign(l,s),r)?r?(0,i.jsx)("div",{style:{position:"fixed",top:"0",left:"0",width:"100%",height:"100%",backgroundColor:"#00000055",zIndex:"3"},children:(0,i.jsx)("div",{style:l,children:o})}):void 0:(0,i.jsx)("div",{style:l,children:o})}let g="/sam_browser/out",h={softBorderColor:"#A9A09E",redColor:"#C56D61",purpleColor:"#55587B",nearBlackColor:"#3d3d3d",worksheetSelectionPanelWidth:"240px",colorMap:{red:"#BD1452",orange:"#FE9350",yellow:"#FFFB79",green:"#91D480",cyan:"#70D9FF",blue:"#2D4CA8",purple:"#8B2F99",pink:"#FF9FDC"},getGenericButtonStyle:function(e){return{padding:"10px",borderRadius:"8px",cursor:"pointer",borderColor:"black",borderStyle:"solid",...{primary:{backgroundColor:"black",color:"white",border:"none"},secondary:{backgroundColor:"white",color:"black"},tertiary:{backgroundColor:"transparent",color:"black",border:"none"}}[e]}},webWorkersFolderPath:g+"/web_workers_for_ws_images",iconsFolderPath:g+"/icons",idbDatabaseVersion:1},x=a(e=>({aWorksheetProcessIsBusy:!1,updateValue:t=>{e(()=>({aWorksheetProcessIsBusy:t}))}})),b=a(e=>({statusMessage:"Retrieving worksheet data from your device...",setStatusMessage:t=>{e(()=>({statusMessage:t}))}})),f=a(e=>({userHasPinchZoomed:!1,setUserHasPinchZoomed:t=>{e(()=>({userHasPinchZoomed:t}))}})),w=a(e=>({addWorksheetModalIsOpen:!1,setAddWorksheetModalIsOpen:t=>{e(()=>({addWorksheetModalIsOpen:t}))},studentAddingFor:null,setStudentAddingFor:t=>{e(()=>({studentAddingFor:t}))}}));function S(){let e;let{studentAddingFor:t}=w.getState();if("other"==t)e="Other";else{let{allStudents:n}=Y.getState();e=n[t].name}return(0,i.jsxs)(p,{blockBehind:!0,widthSetting:"96%",heightSetting:"96%",additionalStyleObject:{boxSizing:"border-box",display:"flex",flexDirection:"column",maxWidth:"1000px",maxHeight:"700px"},children:[(0,i.jsxs)("div",{width:"100%",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[" ",(0,i.jsxs)("h1",{style:{fontFamily:"Roboto, sans-serif",fontSize:"18px",fontWeight:"normal",margin:"0"},children:["Add Worksheet for ",e]}),(0,i.jsx)(u,{buttonWidthString:"37px",iconWidthString:"22px",color:"black",onClickFunction:function(){w.setState({addWorksheetModalIsOpen:!1})},additionalStyleObject:{top:"10px",right:"10px"}})]}),(0,i.jsxs)("div",{style:{display:"flex",height:"100%"},children:[" ",(0,i.jsx)("div",{style:{flexGrow:"1"},children:"Hello"}),(0,i.jsx)(y,{})]})]})}function y(){let e=function(e){console.log(e)},t=t=>{let n,{val:o}=t,s={backgroundColor:"white",border:"1px solid #DAD6D5",boxShadow:"0px 1px 4px #0000001a",width:"65px",height:"65px",color:"#3D3D3D",borderRadius:"20px",fontFamily:"Roboto, sans-serif",fontSize:"30px",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center"};return"backspace"==o?n=(0,i.jsx)("img",{src:h.iconsFolderPath+"/backspace.svg",alt:"Backspace",style:{width:"26px",height:"26px"}}):"clear"==o?(n="Clear",s.backgroundColor=h.redColor,s.color="white",s.fontSize="20px"):"open"==o?(n="Open",s.width="100px",s.backgroundColor="#eae4d444",s.border="1px solid rgb(204, 194, 166)",s.fontSize="20px"):n=o,(0,i.jsx)("button",{onClick:()=>{e(o)},style:s,children:n})},n={display:"flex",gap:"6px",justifyContent:"center",marginBottom:"6px"};return(0,i.jsxs)("div",{style:{margin:"auto 0"},children:[(0,i.jsxs)("div",{style:n,children:[(0,i.jsx)(t,{val:"1"}),(0,i.jsx)(t,{val:"2"}),(0,i.jsx)(t,{val:"3"})]}),(0,i.jsxs)("div",{style:n,children:[(0,i.jsx)(t,{val:"4"}),(0,i.jsx)(t,{val:"5"}),(0,i.jsx)(t,{val:"6"})]}),(0,i.jsxs)("div",{style:n,children:[(0,i.jsx)(t,{val:"7"}),(0,i.jsx)(t,{val:"8"}),(0,i.jsx)(t,{val:"9"})]}),(0,i.jsxs)("div",{style:n,children:[(0,i.jsx)(t,{val:"backspace"}),(0,i.jsx)(t,{val:"0"}),(0,i.jsx)(t,{val:"clear"})]}),(0,i.jsx)("div",{style:{display:"flex",gap:"6px",justifyContent:"center"},children:(0,i.jsx)(t,{val:"open"})})]})}let j=a(e=>({pagesAreHidden:!1,setPagesAreHidden:t=>e({pagesAreHidden:t})}));function m(){let e=x().aWorksheetProcessIsBusy,t=b().statusMessage,{pageView:n}=q(),o=null,s={width:"100%",height:"100%",containerType:"size",boxSizing:"border-box",display:"flex"};return e?o=(0,i.jsx)("div",{id:"wrapper-for-both-pages",style:s,children:(0,i.jsx)("p",{children:t})}):("double"==n&&(o=(0,i.jsxs)("div",{id:"wrapper-for-both-pages",style:s,children:[(0,i.jsx)("div",{id:"wrapper-for-single-page",style:{position:"relative",width:"50%",marginRight:"".concat(16,"px"),height:"100%"},children:(0,i.jsx)(v,{isLeftOrRight:"left"})}),(0,i.jsx)("div",{id:"wrapper-for-single-page",style:{position:"relative",width:"50%",height:"100%"},children:(0,i.jsx)(v,{isLeftOrRight:"right"})})]})),"single"==n&&(o=(0,i.jsx)("div",{id:"wrapper-for-both-pages",style:s,children:(0,i.jsx)("div",{id:"wrapper-for-single-page",style:{position:"relative",width:"100%",height:"100%"},children:(0,i.jsx)(v,{isLeftOrRight:"left"})})}))),(0,i.jsxs)("div",{style:{flexGrow:1,flexBasis:"0%",height:"100%",padding:"16px",paddingRight:"8px",boxSizing:"border-box",display:"flex",flexDirection:"column",containerType:"size"},children:[o,(0,i.jsx)(k,{})]})}function k(){let{pageView:e}=q(),t=h.iconsFolderPath+("single"==e?"/single_page_view.svg":"/two_page_view.svg"),n=(0,i.jsx)(c,{isFilled:!0,isShort:!0,additionalStyleObject:{paddingLeft:"min(1.5vw, 24px)",paddingRight:"min(1.5vw, 24px)",minWidth:"45px"},onClickFunction:function(){let{pageView:e,setPageView:t}=q.getState(),n="double"==e?"single":"double";t(n);let{currentPageOfWorksheet:i,setCurrentPageOfWorksheet:o}=J.getState(),s=i;"single"==n&&0==s&&(s=1),"double"==n&&s%2==1&&s--,o(s)},children:(0,i.jsx)("img",{src:t,alt:"Toggle Page View"})}),o=(0,i.jsxs)(c,{isFilled:!1,isShort:!0,additionalStyleObject:{paddingLeft:"min(1.5vw, 24px)",paddingRight:"min(1.5vw, 24px)"},onClickFunction:A,children:[(0,i.jsx)("p",{style:{margin:"0",padding:"0",marginRight:"10px",fontSize:"min(1.6vw, 16px)",textWrap:"nowrap"},children:"Move"}),(0,i.jsx)("img",{src:h.iconsFolderPath+"/move.svg",alt:"Move",style:{width:"19px",height:"15px"}})]}),s=(0,i.jsxs)(c,{isFilled:!0,isShort:!0,additionalStyleObject:{paddingLeft:"min(1.5vw, 24px)",paddingRight:"min(1.5vw, 24px)",zIndex:"2"},onClickFunction:()=>{console.log("log worksheet button clicked")},children:[(0,i.jsx)("p",{style:{margin:"0",padding:"0",marginRight:"14px",fontSize:"min(1.6vw, 16px)",textWrap:"nowrap"},children:"Log worksheet"}),(0,i.jsx)("img",{src:h.iconsFolderPath+"/arrow_up.svg",alt:"Expand",style:{width:"14px",height:"7px"}})]}),{pagesAreHidden:r}=j(),l=(0,i.jsx)(c,{isFilled:!0,isShort:!0,additionalStyleObject:{paddingLeft:"min(2vw, 30px)",paddingRight:"min(2vw, 30px)"},onClickFunction:function(){let{pagesAreHidden:e,setPagesAreHidden:t}=j.getState();t(!e)},children:r?(0,i.jsx)("img",{id:"toggle-hidden",src:h.iconsFolderPath+"/hidden.svg",alt:"Toggle visibility"}):(0,i.jsx)("img",{id:"toggle-visible",src:h.iconsFolderPath+"/visible.svg",alt:"Toggle visibility"})}),d=function(e){let{currentPageOfWorksheet:t,setCurrentPageOfWorksheet:n,getCurrentWorksheetID:i}=J.getState();if(null==i())return;let{pageView:o}=q.getState(),s="single"==o?1:2,r=i(),l=t;"prev"==e&&(l-=s),"next"==e&&(l+=s);let d="single"==o?1:0,a=X[r].pageCount;"double"==o&&a%2==1&&(a-=1),l<d&&(l=d),l>a&&(l=a),n(l)},a=(0,i.jsx)(c,{isFilled:!1,isShort:!0,additionalStyleObject:{paddingLeft:"min(2vw, 30px)",paddingRight:"min(2vw, 30px)",zIndex:"2"},onClickFunction:()=>{d("prev")},children:(0,i.jsx)("img",{src:h.iconsFolderPath+"/arrow_left.svg",alt:"Previous Page",style:{width:"15px",height:"20px"}})}),u=(0,i.jsx)(c,{isFilled:!1,isShort:!0,additionalStyleObject:{paddingLeft:"min(2vw, 30px)",paddingRight:"min(2vw, 30px)",zIndex:"2"},onClickFunction:()=>{d("next")},children:(0,i.jsx)("img",{src:h.iconsFolderPath+"/arrow_right.svg",alt:"Next Page",style:{width:"15px",height:"20px"}})}),p={display:"flex",gap:"8px"};return(0,i.jsxs)("div",{style:{paddingTop:"16px",display:"flex",gap:"8px",justifyContent:"space-between"},children:[(0,i.jsxs)("div",{style:p,children:[n,l,o,s]}),(0,i.jsxs)("div",{style:p,children:[a,u]})]})}function v(e){let{isLeftOrRight:t}=e,{currentPageOfWorksheet:n,getCurrentWorksheetID:o}=J(),s="left"==t?n:n+1,r=null,l=o();return l&&(X[l]?X[l].pageBlobs[s]&&(r=X[l].pageBlobs[s]):r="worksheet_not_available"),(0,i.jsxs)("div",{style:{position:"absolute",inset:0,marginLeft:"auto",maxHeight:"100%",aspectRatio:"496 / 702"},children:[(0,i.jsx)(W,{pageImageBlob:r}),(0,i.jsx)(C,{isLeftOrRight:t,pageNumber:s,pageExists:null===r})]})}function C(e){let{isLeftOrRight:t,pageNumber:n,pageExists:o}=e,s={position:"absolute",bottom:"15px",width:"44px",height:"44px",backgroundColor:"white",borderRadius:"4px",border:"1px solid #3D3D3D",justifyContent:"center",alignItems:"center",fontSize:"18px",display:o?"none":"flex"};return s[t]="15px",(0,i.jsx)("div",{style:s,children:n})}function W(e){let{pageImageBlob:t}=e,n={width:"100%",height:"100%",border:"1px solid #A9A09E",borderRadius:"12px",backgroundColor:"white",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",boxSizing:"border-box"},{pagesAreHidden:o}=j();if(null===t||o)return(0,i.jsx)("div",{style:n});if("worksheet_not_available"===t)return(0,i.jsxs)("div",{style:n,children:[(0,i.jsx)("p",{style:{fontSize:"14px",textWrap:"balance",textAlign:"center"},children:"Error"}),(0,i.jsx)("p",{style:{fontSize:"14px",textWrap:"balance",textAlign:"center"},children:"It appears this worksheet is not downloaded to your system."})]});let s=URL.createObjectURL(t);return(0,i.jsx)("img",{src:s,style:n})}function I(){let e={width:h.worksheetSelectionPanelWidth,height:"100%",padding:"16px",paddingLeft:"8px",boxSizing:"border-box",overflowY:"scroll",containerType:"size"},t=J().openStudents;return(0,o.useEffect)(()=>{window.openStudents=t},[]),(0,i.jsxs)("div",{style:{height:"100%",flexGrow:0,flexBasis:"0%",display:"flex",flexDirection:"column"},children:[(0,i.jsxs)("div",{style:e,children:[t.map((e,t)=>(0,i.jsx)(O,{studentIDNumber:e.studentIDNumber},e.studentIDNumber)),(0,i.jsx)(L,{})]}),(0,i.jsx)(F,{})]})}function F(){let e=(0,i.jsx)(c,{isFilled:!1,isShort:!0,additionalStyleObject:{paddingLeft:"min(1.5vw, 24px)",paddingRight:"min(1.5vw, 24px)"},onClickFunction:()=>{console.log("view log button clicked")},children:(0,i.jsx)("p",{style:{margin:"0",padding:"0",fontSize:"min(1.6vw, 16px)",textWrap:"nowrap"},children:"View log"})}),t=(0,i.jsx)(c,{isFilled:!1,isShort:!0,additionalStyleObject:{paddingLeft:"min(1.5vw, 30px)",paddingRight:"min(1.5vw, 30px)"},onClickFunction:()=>{J.getState().setCurrentPage("SettingsPage")},children:(0,i.jsx)("img",{src:h.iconsFolderPath+"/settings.svg",alt:"Settings",style:{width:"23px",height:"23px"}})});return(0,i.jsxs)("div",{style:{paddingTop:"16px",display:"flex",justifyContent:"flex-end",gap:"8px",marginBottom:"16px",marginRight:"16px",borderTop:"1px solid #A9A09E"},children:[e,t]})}function O(e){let t,{studentIDNumber:n}=e,{allStudents:o}=Y.getState();t="other"==n?{name:"Other",color:"none"}:o[n];let s={width:"100%",backgroundColor:"white",borderRadius:"12px",boxShadow:"0px 1px 2px rgba(0, 0, 0, 0.45)",boxSizing:"border-box",marginBottom:"12px",overflow:"hidden",position:"relative"};return"other"==n&&(s.border="1px solid #eeeeee"),(0,i.jsxs)("div",{style:s,children:[(0,i.jsx)(M,{studentName:t.name,studentIDNumber:n}),(0,i.jsx)(P,{studentIDNumber:n}),(0,i.jsx)(R,{studentIDNumber:n})]})}function D(e){let t=J.getState().openStudents;return{thisStudent:t.filter(t=>t.studentIDNumber==e)[0],thisStudentIndex:t.findIndex(t=>t.studentIDNumber==e)}}function P(e){let{studentIDNumber:t}=e,{allStudents:n}=Y.getState(),{openStudents:o,currentWorksheet:s}=J(),r={display:"flex",flexDirection:"column",padding:"10px 4px",overflowY:"auto",height:"100%"};"other"==t&&(r.paddingTop="0px");let{thisStudent:l,thisStudentIndex:d}=D(t),a=[];for(let e=0;e<l.openWorksheets.length;e++){let t=l.openWorksheets[e].id,n=s.openStudentIndex==d&&s.worksheetIndex==e,o=function(){let{setCurrentWorksheet:t,setUserIsMovingCurrentWorksheet:n,setCurrentPageOfWorksheet:i,openStudents:o}=J.getState(),{pageView:s}=q.getState();t(d,e),n(!1);let r=o[d].openWorksheets[e].pageLeftOff;"single"==s&&0==r&&(r=1),"double"==s&&r%2==1&&r--,i(r)};a.push((0,i.jsx)(_,{worksheetID:t,isCurrentWorksheet:n,onClick:o},t))}return(0,i.jsx)("div",{style:r,children:a})}function _(e){let{worksheetID:t,isCurrentWorksheet:n,onClick:o}=e,s={fontFamily:"Roboto, sans-serif",fontWeight:"normal",fontSize:"12px",border:"none",backgroundColor:"white",padding:"6px",cursor:n?"arrow":"pointer",textAlign:"left",width:"100%",borderRadius:"12px",color:"inherit",boxSizing:"border-box",display:"flex",justifyContent:"space-between",alignItems:"center"},r=t.slice(0,-3);return n?(s.backgroundColor="#55587B26",(0,i.jsxs)("div",{style:s,children:[(0,i.jsx)("p",{style:{margin:0,whiteSpace:n?"normal":"nowrap",overflow:"hidden",textOverflow:"ellipsis",flexShrink:1},children:r}),(0,i.jsx)("div",{style:{display:"flex"},children:(0,i.jsx)(u,{buttonWidthString:"24px",iconWidthString:"14px",color:"black",onClickFunction:function(){let e=J.getState().currentWorksheet;J.getState().openStudents[e.openStudentIndex].openWorksheets.splice(e.worksheetIndex,1),J.getState().setCurrentWorksheet(null,null),J.getState().setUserIsMovingCurrentWorksheet(!1)},additionalStyleObject:{flexShrink:0}})})]})):(0,i.jsx)("button",{style:s,onClick:o,children:r})}function A(){let{userIsMovingCurrentWorksheet:e,setUserIsMovingCurrentWorksheet:t,setUserCanClickAnywhereToDisableMovingCurrentWorksheet:n,currentWorksheet:i}=J.getState();null!==i.openStudentIndex&&(e||n(!0),t(!e))}function R(e){let{studentIDNumber:t}=e,n={backgroundColor:"white",border:"2px solid ".concat(h.softBorderColor),borderRadius:"50%",cursor:"pointer",width:"40px",height:"40px",verticalAlign:"middle",display:"flex",alignItems:"center",justifyContent:"center"};return(0,i.jsxs)("div",{style:{backgroundColor:"none",padding:"14px 14px",paddingTop:"0px",justifyContent:"space-between",alignItems:"center",display:"flex"},children:[(0,i.jsx)(z,{styleObject:n,studentIDNumber:t}),(0,i.jsx)(B,{styleObject:n,studentIDNumber:t})]})}function z(e){let{studentIDNumber:t,styleObject:n}=e;return(0,i.jsx)("button",{style:n,children:(0,i.jsx)("img",{src:h.iconsFolderPath+"/timer.svg",alt:"Start timer",style:{width:"23px",height:"23px"}})})}function B(e){let{studentIDNumber:t,styleObject:n}=e;return(0,i.jsx)("button",{style:n,onClick:function(){w.getState().setAddWorksheetModalIsOpen(!0),w.getState().setStudentAddingFor(t)},children:(0,i.jsx)("img",{src:h.iconsFolderPath+"/add_black.svg",alt:"Add worksheet",style:{width:"16px",height:"16px"}})})}function L(){return(0,i.jsxs)(c,{isFilled:!0,isShort:!0,onClickFunction:()=>{console.log("Add student")},additionalStyleObject:{margin:"0 auto",paddingLeft:"30px",paddingRight:"30px"},children:[(0,i.jsx)("img",{src:h.iconsFolderPath+"/add_white.svg",alt:"Add student",style:{width:"12px",height:"12px",marginRight:"8px"}}),(0,i.jsx)("p",{style:{margin:"0",padding:"0"},children:"Add Students"})]})}function M(e){let t,{studentName:n,studentIDNumber:o}=e,{allStudents:s}=Y.getState(),{userIsMovingCurrentWorksheet:r,openStudents:l,currentWorksheet:d}=J.getState();t="other"==o?{name:"Other",color:"none"}:s[o];let a={display:"flex",justifyContent:"space-between",alignItems:"center",backgroundColor:h.redColor,padding:"6px 10px","--original-bg-color":h.redColor,"--pulsate-bg-color":"#eb9286",cursor:r?"pointer":"default"},c={margin:0,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",color:"white",fontWeight:"normal",fontSize:"12px"},p={width:"18px",height:"18px",borderRadius:"50%",backgroundColor:h.colorMap[t.color],marginRight:"10px"};"other"==o&&(p.backgroundColor="#00000000",a.backgroundColor="white",a.justifyContent="center",a.padding="10px 0px",a["--original-bg-color"]="rgb(223, 223, 223)",a["--pulsate-bg-color"]="white",c.color="black");let g=(0,i.jsx)(u,{buttonWidthString:"24px",iconWidthString:"14px",color:"white",onClickFunction:()=>{let{deleteOpenStudent:e}=J.getState();e(o)}});return r&&(g=(0,i.jsx)("div",{style:{width:"24px",height:"24px"}})),"other"==o&&(g=null),(0,i.jsxs)("div",{style:a,className:r?"pulsatingHeader":null,onClick:r?function(){let{thisStudentIndex:e}=D(o),{setOpenStudents:t,setCurrentWorksheet:n}=J.getState();if(e!==d.openStudentIndex){let i=[...l];i[e].openWorksheets.push(l[d.openStudentIndex].openWorksheets[d.worksheetIndex]),l[d.openStudentIndex].openWorksheets.splice(d.worksheetIndex,1),t(i),n(e,i[e].openWorksheets.length-1)}}:null,children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:["other"==o?null:(0,i.jsx)("div",{style:p}),(0,i.jsx)("h1",{style:c,children:n})]}),g]})}function N(e){b.getState().setStatusMessage(e)}function V(){let e=h.getGenericButtonStyle("primary"),t=o.useRef(null),n=x().aWorksheetProcessIsBusy,s=async function(e){if(0===e.target.files.length)return;let t=e.target.files[0];(function(e){for(let t in e){let n=t.split("_-")[0],i=Number(t.split("_-")[1].split(".")[0]);if(X[n])X[n].pageBlobs[i]=e[t].blob;else{let o={};o[i]=e[t].blob,X[n]={pageBlobs:o,is_old:t.includes("(OLD)"),localization:t.includes("(USA)")?"USA":"only",pageCount:"unknown"}}}(function(){for(let e in X)"only"==X[e].localization&&function(e){let t=e.replace(/\D/g,"");for(let e in X){let n=e.replace(/\D/g,"");if(e.includes("(USA)")&&n==t)return!0}return!1}(e)&&(X[e].localization="NON-USA"),X[e].pageCount=Object.keys(X[e].pageBlobs).length})()})(await E(t)),function(){let e=new Worker(h.webWorkersFolderPath+"/worker_for_store_files_in_idb.js"),t={worksheets:X,idbDatabaseVersion:h.idbDatabaseVersion};e.postMessage(t),e.onmessage=function(e){"status_update_from_web_worker"==e.data.type&&N(e.data.content),"confirm_transaction_complete"==e.data.type&&x.getState().updateValue(!1)},x.getState().updateValue(!0)}()};return(0,i.jsxs)("div",{children:[(0,i.jsx)("button",{style:e,onClick:()=>{n||t.current.click()},disabled:n,className:"button-with-disabled-variant",children:"Upload Worksheet Image Data"}),(0,i.jsx)("input",{type:"file",style:{display:"none"},ref:t,accept:".tar",onChange:s})]})}async function E(e){N("Extracting images from tar file...");let t=new FileReader,n={},i=0;return new Promise((o,s)=>{t.onload=function(e){untar(t.result).then(function(e){for(let t in e){let o=e[t].name.substring(e[t].name.lastIndexOf("/")+1);if(o.includes(".webp")){let s={name:o,blob:new Blob([e[t].blob],{type:"image/webp"}),size:e[t].size};n[o]=s,i++}else console.log("File not a webp image: "+o)}N(i+" images extracted. Storing worksheets on your device..."),o(n)}).catch(s)},t.onerror=s,t.readAsArrayBuffer(e)})}function T(){let e=h.getGenericButtonStyle("primary"),t=x().aWorksheetProcessIsBusy;return(0,i.jsx)("button",{style:e,onClick:function(){t||U(!0)},disabled:t,className:"button-with-disabled-variant",children:"Retrieve Worksheet Image Data"})}function U(e){x.getState().updateValue(!0);let t=new Worker(h.webWorkersFolderPath+"/worker_for_retrieve_files_from_idb.js"),n={idbDatabaseVersion:h.idbDatabaseVersion};t.postMessage(n),t.onmessage=function(e){if("status_update_from_web_worker"==e.data.type&&N(e.data.content),"worksheets_from_idb"==e.data.type){for(let e in X)X.hasOwnProperty(e)&&delete X[e];Object.assign(X,e.data.content),window.worksheets=X,x.getState().updateValue(!1)}}}function H(){let e=h.getGenericButtonStyle("primary"),t=x().aWorksheetProcessIsBusy;return(0,i.jsx)("button",{style:e,onClick:function(){let e;t||((e=indexedDB.open("worksheetDatabase",h.idbDatabaseVersion)).onupgradeneeded=function(e){e.target.result.createObjectStore("allWorksheets")},e.onsuccess=async function(e){e.target.result.transaction("allWorksheets","readwrite").objectStore("allWorksheets").clear()},N("Worksheet image data cleared."))},disabled:t,className:"button-with-disabled-variant",children:"Clear Worksheet Image Data"})}function Z(){let e=b().statusMessage;return(0,i.jsx)("p",{style:{whiteSpace:"pre-wrap"},children:e})}let G={WorksheetViewer:(0,i.jsx)(function(){(0,o.useEffect)(()=>{window.useAddWorksheetModalIsOpenStore=w},[]);let{addWorksheetModalIsOpen:e}=w();return(0,i.jsxs)("div",{style:{width:"100%",height:"100%",display:"flex",flexShrink:0,containerType:"size"},children:[(0,i.jsx)(m,{}),(0,i.jsx)(I,{}),e?(0,i.jsx)(S,{}):null]})},{}),SettingsPage:(0,i.jsx)(function(){let e=(0,i.jsx)(u,{buttonWidthString:"24px",iconWidthString:"14px",color:"black",onClickFunction:()=>{useSessionStateStore.getState().setCurrentPage("WorksheetViewer")},additionalStyleObject:{position:"absolute",top:"18px",right:"18px"}});return(0,i.jsxs)("div",{style:{width:"100%",height:"100%",boxSizing:"border-box",padding:"16px"},children:[(0,i.jsx)("h1",{children:"Settings"}),e,(0,i.jsx)(V,{}),(0,i.jsx)("br",{}),(0,i.jsx)(T,{}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsx)(H,{}),(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),(0,i.jsx)(Z,{})]})},{})},Y=a(function(e){let t=function(){let e=localStorage.getItem("allStudents");return null!==e?{allStudents:JSON.parse(e)}:{allStudents:{}}};return{allStudents:{},initAllStudents:()=>{e(t)},setAllStudents:t=>{e({allStudents:t})}}});Y.getState().setAllStudents({1:{name:"Sidon",color:"pink"},2:{name:"Yunobo",color:"purple"},3:{name:"Tulin",color:"blue"}});let J=a(e=>({openStudents:[{openWorksheets:[{id:"(OLD) 03.01-05 HF (USA) 1-1 WS",pageLeftOff:0},{id:"(OLD) 03.06-12 TP (USA) 1-1 WS",pageLeftOff:0}],studentIDNumber:"1"},{openWorksheets:[],studentIDNumber:"2"},{openWorksheets:[],studentIDNumber:"other"}],setOpenStudents:t=>{e(()=>({openStudents:t}))},deleteOpenStudent:t=>{let n=J.getState().openStudents.filter(e=>e.studentIDNumber!==t);e(()=>({openStudents:n}))},addOpenStudentToBottom:t=>{let n=J.getState().openStudents.concat({openWorksheets:[],studentIDNumber:t});e(()=>({openStudents:n}))},currentPage:"WorksheetViewer",setCurrentPage:t=>{e(()=>({currentPage:t}))},currentWorksheet:{openStudentIndex:null,worksheetIndex:null},setCurrentWorksheet:(t,n)=>{e(()=>({currentWorksheet:{openStudentIndex:t,worksheetIndex:n}}))},getCurrentWorksheetID:()=>{let{openStudents:e,currentWorksheet:t}=J.getState();return null===t.openStudentIndex||null===t.worksheetIndex?null:e[t.openStudentIndex].openWorksheets[t.worksheetIndex].id},userIsMovingCurrentWorksheet:!1,setUserIsMovingCurrentWorksheet:t=>{e(()=>({userIsMovingCurrentWorksheet:t}))},userCanClickAnywhereToDisableMovingCurrentWorksheet:!1,setUserCanClickAnywhereToDisableMovingCurrentWorksheet:t=>{e(()=>({userCanClickAnywhereToDisableMovingCurrentWorksheet:t}))},currentPageOfWorksheet:0,setCurrentPageOfWorksheet:t=>{e(()=>({currentPageOfWorksheet:t}));let{openStudents:n,currentWorksheet:i}=J.getState();null!==i.openStudentIndex&&null!==i.worksheetIndex&&(n[i.openStudentIndex].openWorksheets[i.worksheetIndex].pageLeftOff=t,e({openStudents:[...n]}))}})),q=a(e=>({pageView:"double",setPageView:t=>{e(()=>({pageView:t}))}}));function K(){return 1!==window.visualViewport.scale}function Q(){K()&&!f.getState().userHasPinchZoomed&&f.getState().setUserHasPinchZoomed(!0)}let X={},$=function(){!function e(t){let n=K();f.getState().userHasPinchZoomed!==n&&f.getState().setUserHasPinchZoomed(n),t&&setTimeout(e(!1),1e3)}(!1)},ee=function(){let{userHasPinchZoomed:e}=f(),{pageView:t}=q();(0,o.useEffect)(()=>(window.visualViewport.addEventListener("resize",Q),document.addEventListener("touchend",$),document.addEventListener("mouseup",$),Q(),()=>{window.visualViewport.removeEventListener("resize",Q),document.removeEventListener("touchend",$),document.removeEventListener("mouseup",$)}),[]);let n={fontFamily:"Roboto, sans-serif",fontWeight:"normal",fontSize:"18px",height:"100%",width:"100%",maxWidth:"double"==t?"1500px":"1000px",color:h.nearBlackColor,touchAction:e?"auto":"pinch-zoom",margin:"0 auto"},s=J(),r=s.currentPage;return(0,o.useEffect)(()=>{window.useAllStudentsStore=Y,window.useSessionStateStore=J,window.useUserSettingsStore=q,U()},[]),(0,i.jsx)("div",{style:n,onClick:function(){"WorksheetViewer"==r&&s.userIsMovingCurrentWorksheet&&s.userCanClickAnywhereToDisableMovingCurrentWorksheet&&(s.setUserIsMovingCurrentWorksheet(!1),s.setUserCanClickAnywhereToDisableMovingCurrentWorksheet(!1))},children:G[r]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[721,59,358],()=>t(4643)),_N_E=e.O()}]);